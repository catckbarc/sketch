Straight fork from QuackBarc with some UI changes
